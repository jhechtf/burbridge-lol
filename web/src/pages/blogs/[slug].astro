---
import Main from '$layouts/main.astro';
import { getPayloadInstance} from '$lib/util.ts';
import { RichText } from '@payload-bites/astro-richtext-renderer';

export async function getStaticPaths() {
  const payload = await getPayloadInstance();
  // const payload = await getPayload({ config });
  const blogs = await payload.find({ collection: 'blogs', draft: import.meta.env.DEV, limit: 0 });
  return blogs.docs.map(blog => ({
    params: {
      slug: blog.slug,
    },
    props: {
      blog
    }
  }))
}

const { blog } = Astro.props;
---
<Main title={blog.title}>

  <div class="blog-grid col-span-12">
    
    <div class="text">
      <h1>{blog.title}</h1>

      <RichText data={blog.contents} />
      
    </div>
  </div>
  
</Main>

<style>
  @reference '#app.css';
  .blog-grid {
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: repeat(2, 250px) 1fr;

    .text {
      grid-area: 1 / 3 / -1 / span 8;
    }

    &:has(header) header {
      grid-area: 1 / 1 /  3 / -1;
      background-color: cornflowerblue;
    }

    &:has(header) .text {
      border-radius: var(--radius-2xl) var(--radius-2xl) 0 0 ;
      padding: --spacing(6);
      grid-area: 2 / 3 /  -1 / span 8;
      background-color: var(--color-background-token);
    }
  }
</style>