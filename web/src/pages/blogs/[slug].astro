---
import Contents from '$components/contents/contents.astro';
import Main from '$layouts/main.astro';
import { listBlogs } from '$lib/blogs';
import { paginateFunction, strapiUrl } from '$lib/pagination';

export async function getStaticPaths() {
  const blogs = await paginateFunction(listBlogs);
  return blogs.map((blog) => ({
    params: {
      slug: blog.slug,
    },
    props: {
      blog,
    },
  }));
}

const { blog } = Astro.props;
---
<Main title={blog.title}>

  <div class="blog-grid col-span-12">
    {blog.header && (
      <header>
        <img src={`${strapiUrl}${blog.header.formats.medium.url}`} class="object-cover w-full" alt="">

      </header>
    )}

    
    
    <div class="text">
      <h1>{blog.title}</h1>
      <h2>{blog.publishedAt || blog.updatedAt}</h2>
      
      <Contents contents={blog.contents} />
    </div>
  </div>
  
  
</Main>

<style>
  @reference '#app.css';
  .blog-grid {
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: repeat(2, 250px) 1fr;

    .text {
      grid-area: 1 / 3 / -1 / span 8;
    }

    &:has(header) header {
      grid-area: 1 / 1 /  3 / -1;
      background-color: cornflowerblue;
    }

    &:has(header) .text {
      border-radius: var(--radius-2xl) var(--radius-2xl) 0 0 ;
      padding: --spacing(6);
      grid-area: 2 / 3 /  -1 / span 8;
      background-color: var(--color-background-token);
    }
  }
</style>